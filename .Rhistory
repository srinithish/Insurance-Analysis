library(dtplyr)
library(data.table)
library(dplyr)
library(data.table)
insurance_Original = fread(choose.files())
str(insurance_Original)
library(corplot)
library(corrplot)
install.packages("corrplot")
install.packages("psych")
library(corrplot)
corrplot(insurance_Original)
corrplot(insurance_Original[1,3,4,7])
corrplot(insurance_Original[c(1,3,4,7)])
corrplot(as.data.frame(insurance_Original[,c(1,3,4,7)])
#draw histograms for each to find the distributions
for (i in colnames(df))
ggplot()
corrplot(as.data.frame(insurance_Original[,c(1,3,4,7)]))
corrplot(as.data.frame(insurance_Original)[,c(1,3,4,7)])
corrplot(mtcars)
cor(insurance_Original)
cor(insurance_Original[,c(1,3,5,6)])
str(insurance_Original)
cor(insurance_Original[,c(1,3,4,6)])
insurance_Original[,c(1,3,4,6)]
cor(insurance_Original[,c(1,3,4,7)])
cormatrix = cor(insurance_Original[,c(1,3,4,7)])
corrplot(cormatrix)
corplot = corrplot(cormatrix)
library(psych)
pairs.panels(mtcars)
pairs.panels(insurance_Original)
str(insurance_Original)
table(insurance_Original$children)
insuranceMutated = insurance_Original
childrenDIst  = ggplot() +geom_histogram(data=insuranceMutated$children)
library(ggplot)
library(ggplot2)
childrenDIst  = ggplot() +geom_histogram(data=insuranceMutated$children)
childrenDIst  = ggplot(data = insuranceMutated) + geom_histogram(mapping = aes(x=insuranceMutated$children))
ggplot(data = insuranceMutated) + geom_histogram(mapping = aes(x=insuranceMutated$children))
str(childrenDIst)
+labs(x= "Number of children")
ggplot(data = insuranceMutated) + geom_histogram(mapping = aes(x=insuranceMutated$children))
+labs(x= "Number of children")
ggplot(data = insuranceMutated) + geom_histogram(mapping = aes(x=insuranceMutated$children))
+labs(x = "Number of children")
ggplot(data = insuranceMutated) + geom_histogram(mapping = aes(x=insuranceMutated$children))
+ labs(x = "Number of children")
ggplot(data = insuranceMutated) + geom_histogram(mapping = aes(x=insuranceMutated$children))+ labs(x = "Number of children")
ggplot(data = insuranceMutated) +
geom_histogram(mapping = aes(x=insuranceMutated$children))+
labs(x = "Number of children")+
geom_text(mapping = aes(label = count))
childrenDIst  = ggplot(data = insuranceMutated) +
geom_histogram(mapping = aes(x=insuranceMutated$children))+
labs(x = "Number of children")
library(dtplyr)
library(data.table)
library(dplyr)
library(corrplot)
library(psych)
library(ggplot2)
childrenDIst  = ggplot(data = insuranceMutated) +
geom_histogram(mapping = aes(x=insuranceMutated$children))+
labs(x = "Number of children")
childrenDIst
insuranceMutated$ChildrenBin = ifelse(insuranceMutated$children == 0,"NoChildren",
ifelse(insurance_Original > 0 & insurance_Original <=2,"1to2Children","3to5 Children")
)
insuranceMutated$ChildrenBin
table(insuranceMutated$ChildrenBin)
insuranceMutated$ChildrenBin = ifelse(insuranceMutated$children == 0,"NoChildren",
ifelse(insurance_Original > 0 && insurance_Original <=2,"1to2Children","3to5 Children")
)
table(insuranceMutated$ChildrenBin)
insuranceMutated$ChildrenBin = ifelse(insuranceMutated$children == 0,"NoChildren",
ifelse((insurance_Original$children > 0 & insurance_Original$children <=2),"1to2Children",
"3to5 Children")
)
table(insuranceMutated$ChildrenBin)
?table
table(insuranceMutated[,c("sex","smoker")])
agePlot  =  ggplot(data=insuranceMutated)+geom_histogram(mapping = aes(x=age))
agePlot
table(insuranceMutated$age)
?geom_bar
childrenDIst  = ggplot(data = insuranceMutated) +
geom_histogram(mapping = aes(x=insuranceMutated$children))+
labs(x = "Number of children") +
geom_text(mapping = aes(label = Frequ))
childrenDIst
ggplot(data = insuranceMutated) +
geom_histogram(mapping = aes(x=insuranceMutated$children))+
labs(x = "Number of children")
agePlot
agePlot  =  ggplot(data=insuranceMutated)+geom_histogram(binwidth = 10,mapping = aes(x=age))+
table(insuranceMutated$age)
agePlot  =  ggplot(data=insuranceMutated)+geom_histogram(binwidth = 10,mapping = aes(x=age))
agePlot
agePlot  =  ggplot(data=insuranceMutated)+geom_histogram(binwidth = 30,mapping = aes(x=age))
agePlot
agePlot  =  ggplot(data=insuranceMutated)+geom_histogram(binwidth = 1,mapping = aes(x=age))
agePlot
agePlot  =  ggplot(data=insuranceMutated)+geom_histogram(binwidth = 5,mapping = aes(x=age))
agePlot
agePlot  =  ggplot(data=insuranceMutated)+geom_histogram(bins = 40,mapping = aes(x=age))
agePlot
agePlot  =  ggplot(data=insuranceMutated)+geom_histogram(binwidth = 5,mapping = aes(x=age))
agePlot
table(insuranRceMutated$age)
table(insuranceMutated$age)
cut(insuranceMutated$age,breaks = 10)
table(cut(insuranceMutated$age,breaks = 10))
braeakpoints = seq(15,65,10)
table(cut(insuranceMutated$age,breaks = breakpoints))
table(cut(insuranceMutated$age,breaks = braeakpoints))
agePlot
agePlot  =  ggplot(data=insuranceMutated)+geom_histogram(binwidth = 10,mapping = aes(x=age))
agePlot
agePlot  =  ggplot(data=insuranceMutated)+geom_histogram(binwidth = 10,mapping = aes(x=age),color = "blue")
agePlot
agePlot  =  ggplot(data=insuranceMutated)+geom_histogram(binwidth = 10,mapping = aes(x=age),color = "blue",fill="orange")
agePlot
?geom_histogram
agePlot$labels
agePlot$data
ggplot(data = insuranceMutated)+geom_point(mapping = aes(x=age,y=charges))
ggplot(data = insuranceMutated)+geom_point(mapping = aes(x=age,y=charges),position = "jitter")
ggplot(data = insuranceMutated)+geom_point(mapping = aes(x=age,y=charges),position = "jitter",alpha = 0.2)
ggplot(data = insuranceMutated)+geom_point(mapping = aes(x=age,y=charges),position = "jitter",alpha = 1/100)
ggplot(data = insuranceMutated)+geom_point(mapping = aes(x=age,y=charges),position = "jitter",alpha = 1/20)
ggplot(data = insuranceMutated)+geom_point(mapping = aes(x=age,y=charges),position = "jitter",alpha = 1/5)
ggplot(data = insuranceMutated)+geom_point(mapping = aes(x=age,y=charges),alpha = 1/5)
ggplot(data = insuranceMutated)+geom_jitter(mapping = aes(x=age,y=charges),alpha = 1/5)
ggplot(data = insuranceMutated)+geom_jitter(mapping = aes(x=age,y=charges),height = 4,width = 0,alpha = 1/5)
ggplot(data = insuranceMutated)+geom_jitter(mapping = aes(x=age,y=charges),height = 4,width = 0,alpha = 1/5)
ggplot(data = insuranceMutated)+geom_jitter(mapping = aes(x=age,y=charges),height = 4,width = 2,alpha = 1/5)
ggplot(data = insuranceMutated)+geom_jitter(mapping = aes(x=age,y=charges),height = 4,width = 20,alpha = 1/5)
ggplot(data = insuranceMutated)+geom_jitter(mapping = aes(x=age,y=charges),height = 4,width = 0,alpha = 1/5)
ggplot(data = insuranceMutated)+geom_jitter(mapping = aes(x=age,y=charges,color = smoker),height = 4,width = 0,alpha = 1/5)
+facet_wrap(.~sex)
+facet_wrap(~sex)
ggplot(data = insuranceMutated)+geom_jitter(mapping = aes(x=age,y=charges,color = smoker),height = 4,width = 0,alpha = 1/5)+
facet_wrap(~sex)
p4  = ggplot(data = insuranceMutated)+geom_jitter(mapping = aes(x=age,y=charges,color = smoker),height = 4,width = 0,alpha = 1/5)+
facet_wrap(~sex)
p4
p5 = ggplot(data = insuranceMutated) + geom_area(mapping = aes(x=charges))
p5
p5 = ggplot(data = insuranceMutated) + geom_area(mapping = aes(x=charges),stat = "bin")
p5
p5 = ggplot(data = insuranceMutated) + geom_area(mapping = aes(x=charges),stat = "bin")+facet_wrap(~sex)
p5
table(insuranceMutated[,c("sex","smoker")])
p4
p4  = ggplot(data = insuranceMutated)+geom_jitter(mapping = aes(x=age,y=charges,color = smoker,shape = region),height = 4,width = 0,alpha = 1/5)+
facet_wrap(~sex)
p4
p5 = ggplot(data = insuranceMutated) + geom_area(mapping = aes(x=charges),stat = "bin")+facet_wrap(~sex+region)
p5
p4  = ggplot(data = insuranceMutated)+geom_jitter(mapping = aes(x=age,y=charges,color = smoker,shape = region),height = 4,width = 0,alpha = 1/5)+
facet_wrap(~sex=region)
p4  = ggplot(data = insuranceMutated)+geom_jitter(mapping = aes(x=age,y=charges,color = smoker,shape = region),height = 4,width = 0,alpha = 1/5)+
facet_wrap(~sex+region)
p4
p4  = ggplot(data = insuranceMutated)+geom_jitter(mapping = aes(x=age,y=charges,color = smoker),height = 4,width = 0,alpha = 1/5)+
facet_wrap(~sex+region)
p4
p4  = ggplot(data = insuranceMutated)+geom_jitter(mapping = aes(x=age,y=charges,color = smoker),height = 4,width = 0,alpha = 1/2)+
facet_wrap(~sex+region)
p4
p4  = ggplot(data = insuranceMutated)+geom_jitter(mapping = aes(x=age,y=charges,color = smoker),height = 4,width = 0,alpha = 1/2)+
facet_wrap(~region+sex)
p4
p4  = ggplot(data = insuranceMutated)+geom_jitter(mapping = aes(x=age,y=charges,color = smoker),height = 4,width = 0,alpha = 1/2)+
facet_wrap(~sex)
p4
corplot = corrplot(cormatrix)
p4
ggsave(filename = "f_m_s_ns_cahrges_age",plot = p4)
ggsave(filename = "f_m_s_ns_cahrges_age.jpg",plot = p4)
?ggsave()
ggsave(filename = "f_m_s_ns_cahrges_age.jpg",plot = p4,dpi = 500)
ggsave(filename = "f_m_s_ns_cahrges_age.jpg",plot = p4,dpi = 1000)
p5
pairs.panels(insurance_Original)
ggplot(data = insuranceMutated)+ geom_jitter(mapping = aes(x=bmi,y=charges))
ggplot(data = insuranceMutated)+ geom_jitter(mapping = aes(x=bmi,y=charges),width = 0)
ggplot(data = insuranceMutated)+ geom_jitter(mapping = aes(x=bmi,y=charges),width = 0,alpha=1/5)
ggplot(data = insuranceMutated)+ geom_jitter(mapping = aes(x=bmi,y=charges),width = 0,alpha=1/2)
ggplot(data = insuranceMutated)+ geom_jitter(mapping = aes(x=bmi,y=charges),width = 3,alpha=1/2)
ggplot(data = insuranceMutated)+ geom_jitter(mapping = aes(x=bmi,y=charges,color=smoker),width = 3,alpha=1/2)
ggplot(data = insuranceMutated)+ geom_jitter(mapping = aes(x=bmi,y=charges,color=smoker,shape=sex),width = 3,alpha=1/2)
p4
p4  = ggplot(data = insuranceMutated)+geom_jitter(mapping = aes(x=age,y=charges,color = smoker,shape=ChildrenBin),height = 4,width = 0,alpha = 1/2)+
facet_wrap(~sex)
p4
p4  = ggplot(data = insuranceMutated)+geom_jitter(mapping = aes(x=age,y=charges,color = smoker,shape=ChildrenBin),height = 4,width = 4,alpha = 1/2)+
facet_wrap(~sex)
p4
p4  = ggplot(data = insuranceMutated)+geom_jitter(mapping = aes(x=age,y=charges,color = smoker,shape=ChildrenBin),height = 4,width = 4,alpha = 1/3)+
facet_wrap(~sex)
p4
ggplot(data = insuranceMutated)+ geom_jitter(mapping = aes(x=bmi,y=charges,color=smoker,shape=sex),width = 3,alpha=1/2)
p6 = ggplot(data = insuranceMutated)+ geom_jitter(mapping = aes(x=bmi,y=charges,color=smoker,shape=sex),width = 3,alpha=1/2)
plotCanvas = ggplot(data = insuranceMutated)
p7 = plotCanvas + geom_boxplot(mapping = aes(x=Children,y=charges))
p7
p7 = plotCanvas + geom_boxplot(mapping = aes(x=children,y=charges))
p7
p7 = plotCanvas + geom_boxplot(mapping = aes(x=as.factor(children),y=charges))
p7
p7 = plotCanvas + geom_boxplot(mapping = aes(x=as.factor(ChildrenBin),y=charges))
p7
p7 = plotCanvas + geom_boxplot(mapping = aes(x=as.factor(ChildrenBin),y=charges))+geom_jitter
p7 = plotCanvas + geom_boxplot(mapping = aes(x=as.factor(ChildrenBin),y=charges))+geom_jitter()
p7
p7 = plotCanvas + geom_boxplot(mapping = aes(x=as.factor(ChildrenBin),y=charges))
p7
library(mass)
library(MASS)
plotCanvas+geom_histogram(mapping = aes(x=charges))
plotCanvas+geom_histogram(mapping = aes(x=charges),binwidth = 1000)
plotCanvas+geom_histogram(mapping = aes(x=log(charges),binwidth = 1000)
plotCanvas+geom_histogram(mapping = aes(x=log(charges),binwidth = 1000))
plotCanvas+geom_histogram(mapping = aes(x=log(charges),binwidth = 10))
plotCanvas+geom_histogram(mapping = aes(x=log(charges)),binwidth = 10)
plotCanvas+geom_histogram(mapping = aes(x=log(charges)),binwidth = 1)
plotCanvas+geom_histogram(mapping = aes(x=log(charges)),binwidth = 0.1)
insuranceMutated$logCharges = log(insuranceMutated$charges)
lm(logCharges~age+sex+ChildrenBin+bmi+region,data = insuranceMutated)
linearModel = glm(logCharges~age+sex+ChildrenBin+bmi+region,data = insuranceMutated)
linearModel
summary(linearModel)
linearModel = glm(logCharges~age+sex+ChildrenBin+bmi+region+smoker,data = insuranceMutated)
summary(linearModel)
linearModel = lm(logCharges~age+sex+ChildrenBin+bmi+region+smoker,data = insuranceMutated)
summary(linearModel)
linearModel = lm(charges~age+sex+ChildrenBin+bmi+region+smoker,data = insuranceMutated)
summary(linearModel)
linearModel = lm(logCharges~age+ChildrenBin+bmi+region+smoker,data = insuranceMutated)
summary(linearModel)
linearModel = lm(logCharges~sex+age+ChildrenBin+bmi+region+smoker,data = insuranceMutated)
summary(linearModel)
linearModel = lm(logCharges~sex+age+ChildrenBin+bmi+smoker,data = insuranceMutated)
summary(linearModel)
linearModel = lm(logCharges~sex+age+ChildrenBin+bmi+smoker+region,data = insuranceMutated)
stepAIC(linearModel)
stepAIC(linearModel,direction = "both")
linearModel = lm(logCharges~sex+age+Children+bmi+smoker+region,data = insuranceMutated)
linearModel = lm(logCharges~sex+age+children+bmi+smoker+region,data = insuranceMutated)
summary(linearModel)
ggplot(data = linearModel)
ggplot(data = linearModel)+geom_histogram(mapping = aes(x=residuals))
ggplot(data = linearModel$residuals)+geom_histogram(mapping = aes(x=residuals))
ggplot(data = linearModel$residuals)
ggplot(data = as.data.frame(linearModel$residuals))+geom_histogram(mapping = aes(x=asresiduals))
ggplot(data = as.data.frame(linearModel$residuals))+geom_histogram(mapping = aes(x=sresiduals))
ggplot(data = as.data.frame(linearModel$residuals))+geom_histogram(mapping = aes(x=residuals))
ggplot(data = as.data.frame(residuals = linearModel$residuals))+geom_histogram(mapping = aes(x= residuals))
ggplot(data = as.data.frame(residuals =c( linearModel$residuals))+geom_histogram(mapping = aes(x= residuals))
ggplot(data = as.data.frame(residuals =c( linearModel$residuals)))+geom_histogram(mapping = aes(x= residuals))
linearModel$residuals
ggplot()+geom_histogram(mapping = aes(x= residuals))
ggplot()+geom_histogram(mapping = aes(),data = linearModel$residuals)
residualsLM =  linearModel$residuals
colnames(linearModel$residuals) = "res"
colnames(linearModel$residuals) = c("res")
residualsLM =  as.data.frame(linearModel$residuals)
colnames(residualsLM) = c("res")
ggplot()+geom_histogram(mapping = aes(x=res),data = as.data.frame(linearModelLM)
ggplot()+geom_histogram(mapping = aes(x=res),data = as.data.frame(linearModelLM))
ggplot()+geom_histogram(mapping = aes(x=res),data = residualsLM)
p4
plotCanvas+geom_histogram(mapping = aes(x=bmi),binwidth = 5)
summary(insuranceMutated)
plotCanvas+geom_histogram(mapping = aes(x=bmi),binwidth = 2)
install.packages("forcats")
cut(insuranceMutated$bmi,breaks = c(16,17,18.5,24.9,29.9,34.9,39.9,40),
labels = c("SevereM","ModerateM","MildM","Normal","OverWeight","Obese1","Obese2","Obese3"))
table(cut(insuranceMutated$bmi,breaks = c(16,17,18.5,24.9,29.9,34.9,39.9,40))),
labels = c("SevereM","ModerateM","MildM","Normal","OverWeight","Obese1","Obese2","Obese3"))
table(cut(insuranceMutated$bmi,breaks = c(16,17,18.5,24.9,29.9,34.9,39.9,40)))
table(cut(insuranceMutated$bmi,breaks = c(0,16,17,18.5,24.9,29.9,34.9,39.9,40)))
table(cut(insuranceMutated$bmi,breaks = c(0,16,17,18.5,24.9,29.9,34.9,39.9,40,60)))
table(cut(insuranceMutated$bmi,breaks = c(0,16,17,18.5,24.9,29.9,34.9,39.9,60)))
cut(insuranceMutated$bmi,breaks = c(0,16,17,18.5,24.9,29.9,34.9,39.9,60),
labels = c("SevereM","ModerateM","MildM","Normal","OverWeight","Obese1","Obese2","Obese3"))
insuranceMutated$bmiClass = cut(insuranceMutated$bmi,breaks = c(0,16,17,18.5,24.9,29.9,34.9,39.9,60),
labels = c("SevereM","ModerateM","MildM","Normal","OverWeight","Obese1","Obese2","Obese3"))
p6 = ggplot(data = insuranceMutated)+ geom_jitter(mapping = aes(x=bmi,y=charges,color=smoker,shape=bmiClass),width = 3,alpha=1/2)
p6
p4  = ggplot(data = insuranceMutated)+geom_jitter(mapping = aes(x=age,y=charges,color = smoker,shape=bmiClass),height = 4,width = 4,alpha = 1/3)+
facet_wrap(~sex)
p4
glimpse(insuranceMutated)
str(insuranceMutated)
linearModel = lm(logCharges~sex+age+children+bmiClass+smoker+region,data = insuranceMutated)
summary(linearModel)
linearModel = lm(logCharges~sex+age+children+bmi+smoker+region,data = insuranceMutated)
summary(linearModel)
library(forcats)
insuranceMutated %>% mutate(bmiCollapsedClass = fct_collapse(bmiClass,
underWeight = c("SevereM","ModerateM","MildM"),
normal = c("Normal"),
OverWeight = c("OverWeight","Obese1","Obese2","Obese3")
))
View(insuranceMutated)
insuranceMutated = insuranceMutated %>% mutate(bmiCollapsedClass = fct_collapse(bmiClass,
underWeight = c("SevereM","ModerateM","MildM"),
normal = c("Normal"),
OverWeight = c("OverWeight","Obese1","Obese2","Obese3")
))
linearModel = lm(logCharges~sex+age+children+bmiCollapsedClass+smoker+region,data = insuranceMutated)
summary(linearModel)
linearModel = lm(logCharges~sex+age+children+bmiClass+smoker+region,data = insuranceMutated)
summary(linearModel)
linearModel = lm(logCharges~sex+age+as.factor(children)+bmiClass+smoker+region,data = insuranceMutated)
summary(linearModel)
insuranceMutated = insuranceMutated %>% mutate(bmiCollapsedClass = fct_collapse(bmiClass,
underWeight = c("SevereM","ModerateM","MildM"),
normal = c("Normal"),
OverWeight = c("OverWeight","Obese1","Obese2","Obese3")
)) %>% mutate(children = as.factor(children))
linearModel = lm(logCharges~sex+age+children+bmiClass+smoker+region,data = insuranceMutated)
summary(linearModel)
linearModel = lm(logCharges~sex+age+children+bmiClass+smoker,data = insuranceMutated)
summary(linearModel)
linearModel = lm(logCharges~sex+age+children+bmiClass+smoker+region,data = insuranceMutated)
summary(linearModel)
linearModel = lm(logCharges~sex+age+children+smoker+region,data = insuranceMutated)
summary(linearModel)
linearModel = lm(logCharges~sex+age+children+smoker+bmiClass+region,data = insuranceMutated)
stepAIC(linearModel,direction = "both")
p4  = ggplot(data = insuranceMutated)+geom_jitter(mapping = aes(x=age,y=charges,color = smoker,shape=bmiCollapsedClass),height = 4,width = 4,alpha = 1/3)+
facet_wrap(~sex)
p4
linearModel = lm(logCharges~sex+age+smoker+bmiClass,data = insuranceMutated)
summary(linearModel)
linearModel = lm(logCharges~sex+age+smoker+bmiCollapsedClass,data = insuranceMutated)
summary(linearModel)
summary(linearModel)
colnames(insuranceMutated)
linearModel = lm(logCharges~sex+age+smoker+bmiClass+children,data = insuranceMutated)
summary(linearModel)
linearModel = lm(logCharges~sex+age+smoker+bmiCollapsedClass+children,data = insuranceMutated)
summary(linearModel)
linearModel = lm(logCharges~region+sex+age+smoker+bmiCollapsedClass+children,data = insuranceMutated)
summary(linearModel)
colnames(insuranceMutated)
ggsave("ChargesVsAge_Smoker_bmi",p4)
ggsave("ChargesVsAge_Smoker_bmi.jpg",p4)
ggsave("ChargesVsAge_Smoker_bmi.jpg",p4)
linearModel = lm(logCharges~region+sex+age+smoker+bmiCollapsedClass+children,data = insuranceMutated)
summary(linearModel)
